<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Primary Meta Tags -->
    <title>Beercap Mosaic Generator ‚Äî Transform Images into Beercap Art</title>
    <meta name="title" content="Beercap Mosaic Generator ‚Äî Transform Images into Beercap Art">
    <meta name="description" content="Free online tool to convert any image into a beercap mosaic. Upload your beercap collection, choose a target image, and get step-by-step assembly instructions. Works offline, no signup required.">
    <meta name="keywords" content="beercap mosaic, bottle cap art, beer cap craft, image to mosaic, mosaic generator, DIY art, beercap art, craft project, pixel art, color matching">
    <meta name="author" content="Beercap Mosaic Generator">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    
    <!-- Theme Color -->
    <meta name="theme-color" content="#1a1a1a">
    <meta name="msapplication-TileColor" content="#ff8a00">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://beercap-mosaic.example.com/">
    <meta property="og:title" content="Beercap Mosaic Generator ‚Äî Transform Images into Beercap Art">
    <meta property="og:description" content="Free online tool to convert any image into a beercap mosaic. Upload your beercap collection, choose a target image, and get step-by-step assembly instructions.">
    <meta property="og:image" content="https://beercap-mosaic.example.com/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="Beercap Mosaic Generator">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://beercap-mosaic.example.com/">
    <meta name="twitter:title" content="Beercap Mosaic Generator ‚Äî Transform Images into Beercap Art">
    <meta name="twitter:description" content="Free online tool to convert any image into a beercap mosaic. Upload your beercap collection and get step-by-step assembly instructions.">
    <meta name="twitter:image" content="https://beercap-mosaic.example.com/og-image.png">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://beercap-mosaic.example.com/">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.css">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üç∫</text></svg>">
    
    <!-- Structured Data / JSON-LD -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Beercap Mosaic Generator",
        "description": "Free online tool to convert any image into a beercap mosaic with step-by-step assembly instructions.",
        "url": "https://beercap-mosaic.example.com/",
        "applicationCategory": "DesignApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "featureList": [
            "Image to mosaic conversion",
            "Beercap library management",
            "Color matching algorithm",
            "Hexagonal and square layouts",
            "Export to PNG and CSV",
            "Works offline"
        ],
        "screenshot": "https://beercap-mosaic.example.com/screenshot.png",
        "softwareVersion": "1.0.0",
        "author": {
            "@type": "Organization",
            "name": "Beercap Mosaic Generator"
        }
    }
    </script>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <h1 class="app-title">Beercap Mosaic</h1>
            <p class="app-subtitle">Transform images into beercap art instructions</p>
        </header>

        <!-- Main Content Grid -->
        <main class="main-grid">
            <!-- Beercap Library Panel -->
            <section class="panel">
                <div class="panel-header">
                    <h2 class="panel-title">Beercap Library</h2>
                    <div class="library-actions">
                        <span class="stats-badge">
                            Total: <strong id="total-caps">0</strong> caps
                        </span>
                        <button id="add-beercap-btn" class="btn btn-primary btn-sm">+ Add</button>
                        <button id="scan-beercaps-btn" class="btn btn-secondary btn-sm">üì∑ Scan</button>
                        <button id="clear-library-btn" class="btn btn-danger btn-sm">Clear</button>
                    </div>
                </div>
                <div class="panel-content">
                    <div id="beercap-list" class="beercap-list">
                        <div class="empty-library">
                            <p>No beercaps added yet.</p>
                            <p>Click "Add Beercap" to start building your library.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Target Image Panel -->
            <section class="panel">
                <div class="panel-header">
                    <h2 class="panel-title">Target Image</h2>
                </div>
                <div class="panel-content">
                    <div id="target-upload-area" class="upload-area">
                        <input type="file" id="target-image-input" accept="image/*">
                        <div id="target-image-placeholder" class="upload-placeholder">
                            <div class="upload-icon">üñºÔ∏è</div>
                            <p class="upload-text">Click or drag image here</p>
                            <p class="upload-hint">Supports JPG, PNG, GIF, WebP</p>
                        </div>
                        <img id="target-image-preview" class="target-preview hidden" alt="Target image preview">
                    </div>
                    
                    <div id="grid-info" class="grid-info">
                        Upload an image and add beercaps to see grid dimensions
                    </div>
                    
                    <div class="layout-toggle">
                        <span class="layout-label">Layout:</span>
                        <div class="toggle-group">
                            <input type="radio" id="layout-square" name="layout" value="square">
                            <label for="layout-square" class="toggle-option">Square</label>
                            <input type="radio" id="layout-hex" name="layout" value="hex" checked>
                            <label for="layout-hex" class="toggle-option">Hexagonal</label>
                        </div>
                    </div>
                    
                    <div class="generate-section">
                        <button id="generate-btn" class="btn btn-primary btn-generate" disabled>
                            Generate Mosaic
                        </button>
                        <div id="wasm-status" class="wasm-status loading">
                            <span class="wasm-icon">‚è≥</span>
                            <span class="wasm-text">Loading WASM...</span>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Output Section -->
        <section id="output-section" class="output-section hidden">
            <div class="output-header">
                <div class="tabs">
                    <button class="tab-btn active" data-tab="visual">Visual Preview</button>
                    <button class="tab-btn" data-tab="reference">Reference Grid</button>
                    <button class="tab-btn" data-tab="stats">Statistics</button>
                </div>
                <div class="export-buttons">
                    <button id="download-png-btn" class="btn btn-secondary btn-sm" disabled>
                        üì• Download PNG
                    </button>
                    <button id="download-csv-btn" class="btn btn-secondary btn-sm" disabled>
                        üìä Export CSV
                    </button>
                </div>
            </div>
            
            <div class="tab-content">
                <!-- Visual Preview Tab -->
                <div id="visual-panel" class="tab-panel active">
                    <div class="canvas-container">
                        <canvas id="visual-canvas"></canvas>
                    </div>
                </div>

                <!-- Reference Grid Tab -->
                <div id="reference-panel" class="tab-panel">
                    <div class="reference-container">
                        <div id="reference-grid"></div>
                    </div>
                    <div class="legend-section">
                        <h4 class="legend-title">Legend</h4>
                        <div id="legend-container" class="legend-container"></div>
                    </div>
                </div>

                <!-- Stats Tab -->
                <div id="stats-panel" class="tab-panel">
                    <div id="stats-content"></div>
                </div>
            </div>
        </section>
    </div>

    <!-- Add Beercap Modal -->
    <div id="beercap-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title" class="modal-title">Add Beercap</h3>
                <button id="modal-close" class="modal-close">&times;</button>
            </div>
            <form id="beercap-form">
                <div class="modal-body">
                    <div class="form-group">
                        <label for="beercap-name" class="form-label">Name</label>
                        <input type="text" id="beercap-name" class="form-input" 
                               placeholder="e.g., Heineken, Corona..." required>
                    </div>
                    
                    <div class="form-group">
                        <label for="beercap-quantity" class="form-label">Quantity Available</label>
                        <input type="number" id="beercap-quantity" class="form-input" 
                               min="0" value="1" required>
                    </div>
                    
                    <div class="form-group">
                        <span class="form-label">Beercap Image</span>
                        <div class="file-input-wrapper">
                            <input type="file" id="beercap-image" accept="image/*" required>
                            <label for="beercap-image" class="file-input-label">
                                üì∑ Click to upload beercap image
                            </label>
                        </div>
                        <div class="beercap-preview-container">
                            <div id="beercap-preview"></div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" id="modal-cancel" class="btn btn-secondary">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Beercap</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Progress Modal -->
    <div id="progress-modal" class="modal progress-modal">
        <div class="modal-content progress-modal-content">
            <div class="progress-modal-icon">‚öôÔ∏è</div>
            <h3 class="progress-modal-title">Generating Mosaic</h3>
            <div class="progress-bar-container">
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill"></div>
                </div>
            </div>
            <div id="progress-text" class="progress-text">Initializing...</div>
            <div id="progress-percent" class="progress-percent">0%</div>
        </div>
    </div>

    <!-- Scan Beercaps Modal -->
    <div id="scan-modal" class="modal scan-modal">
        <div class="modal-content scan-modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Scan Beercaps</h3>
                <button id="scan-modal-close" class="modal-close">&times;</button>
            </div>
            
            <div class="scan-body">
                <!-- Input selection -->
                <div class="scan-input-toggle">
                    <button id="scan-photo-btn" class="scan-toggle-btn active">
                        <span>üì∑</span> Upload Photo
                    </button>
                    <button id="scan-camera-btn" class="scan-toggle-btn">
                        <span>üé•</span> Use Camera
                    </button>
                </div>
                
                <!-- Photo upload area -->
                <div id="scan-photo-area" class="scan-area">
                    <input type="file" id="scan-photo-input" accept="image/*" hidden>
                    <label for="scan-photo-input" class="scan-upload-label">
                        <div class="scan-upload-icon">üñºÔ∏è</div>
                        <p>Click to upload a photo of your beercaps</p>
                        <p class="scan-hint">Spread caps on a contrasting background for best results</p>
                    </label>
                </div>
                
                <!-- Camera area -->
                <div id="scan-camera-area" class="scan-area hidden">
                    <video id="scan-video" autoplay playsinline></video>
                    <button id="scan-capture-btn" class="btn btn-primary">üì∏ Capture</button>
                </div>
                
                <!-- Preview with detections -->
                <div id="scan-preview-area" class="scan-area hidden">
                    <canvas id="scan-canvas"></canvas>
                    <div class="scan-detection-info">
                        <span id="scan-circle-count">0</span> caps detected
                    </div>
                </div>
                
                <!-- Detection progress -->
                <div id="scan-progress" class="scan-progress hidden">
                    <div class="progress-bar">
                        <div id="scan-progress-fill" class="progress-fill"></div>
                    </div>
                    <div id="scan-progress-text" class="progress-text">Analyzing...</div>
                </div>
                
                <!-- Clustered results -->
                <div id="scan-results" class="scan-results hidden">
                    <div id="scan-new-section" class="scan-section hidden">
                        <h4 class="scan-section-title new">üÜï New Caps (<span id="scan-new-count">0</span>)</h4>
                        <div id="scan-new-clusters" class="scan-clusters"></div>
                    </div>
                    <div id="scan-existing-section" class="scan-section hidden">
                        <h4 class="scan-section-title existing">üì¶ Matches Existing (<span id="scan-existing-count">0</span>)</h4>
                        <div id="scan-existing-clusters" class="scan-clusters"></div>
                    </div>
                    <div id="scan-empty-message" class="scan-hint hidden">No beercaps detected. Try a photo with better lighting and contrast.</div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button id="scan-reset-btn" class="btn btn-secondary">Reset</button>
                <button id="scan-add-btn" class="btn btn-primary" disabled>Add All to Library</button>
            </div>
        </div>
    </div>

    <!-- TensorFlow.js for beercap detection -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.17.0/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd@2.2.3/dist/coco-ssd.min.js"></script>
    
    <script type="module" src="js/app.js"></script>
</body>
</html>

